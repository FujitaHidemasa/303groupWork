<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ja">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>購入画面 | FPS GEAR STORE</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
	<!-- 共通ヘッダー -->
	<div th:replace="fragments/header :: header"></div>

	<main class="container mt-5 mb-5">
		<h1 class="text-center mb-4">購入画面</h1>

		<!-- カート内商品一覧 -->
		<div class="card shadow-sm mb-4">
			<div class="card-body">
				<h5 class="mb-3">ご購入商品一覧</h5>

				<table class="table align-middle">
					<thead>
						<tr>
							<th>商品画像</th>
							<th>商品名</th>
							<th>数量</th>
							<th>価格</th>
							<th>小計</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="cv : ${cartItems}">
							<td>
								<img th:src="${cv.item.imagePath != null ? cv.item.imagePath : '/images/default.png'}"
									alt="商品画像" width="80">
							</td>
							<td th:text="${cv.item.name}">商品名</td>
							<td th:text="${cv.cart != null ? cv.cart.quantity : 1}">1</td>
							<td th:text="${#numbers.formatInteger(cv.item.price, 1, 'COMMA')} + '円'">0円</td>
							<td
								th:text="${#numbers.formatInteger(cv.item.price * (cv.cart != null ? cv.cart.quantity : 1), 1, 'COMMA')} + '円'">
								0円
							</td>
						</tr>
					</tbody>
				</table>

				<div class="text-end mt-3">
					<h5>合計金額：
						<span th:text="${#numbers.formatInteger(totalPrice, 1, 'COMMA')} + '円'">0円</span>
					</h5>
				</div>
			</div>
		</div>

		<!-- 支払い方法 -->
		<div class="card shadow-sm mb-4">
			<div class="card-body">
				<h5 class="mb-3">お支払い方法</h5>
				<form th:action="@{/purchase/confirm}" method="post">
					<div class="mb-3">
						<select class="form-select" name="paymentMethod" required>
							<option value="クレジットカード" selected>クレジットカード</option>
							<option value="銀行振込">銀行振込</option>
							<option value="コンビニ払い">コンビニ払い</option>
						</select>
					</div>

					<!-- 確認ボタン -->
					<div class="text-center">
						<button type="submit" class="btn btn-success btn-lg">
							購入内容を確認する
						</button>
					</div>
				</form>
			</div>
		</div>
	</main>

	<footer class="text-center mt-5">
		<p>© 2025 FPS GEAR STORE</p>
	</footer>
</body>

</html>