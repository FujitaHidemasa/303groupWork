<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>お届け先管理｜VOIDR</title>
  <link rel="stylesheet" th:href="@{/css/mypage/mypage.css}">
  <link rel="stylesheet" th:href="@{/css/ec/header.css}">
</head>
<body>

  <!-- 共通ヘッダー -->
  <div th:replace="fragments/header :: header"></div>

  <main class="mypage-container">
	<aside class="mypage-sidebar">
				<h2>メニュー</h2>
				<ul>
					<li>
						<a th:href="@{/mypage/orders}" 
						   th:classappend="${currentPath == '/mypage/orders'} ? 'active'">
						   購入履歴
						</a>
					</li>
					<li>
						<a th:href="@{/mypage/edit}" 
						   th:classappend="${currentPath == '/mypage/edit'} ? 'active'">
						   会員情報変更
						</a>
					</li>
					<li>
						<a th:href="@{/mypage/address}" 
						   th:classappend="${currentPath == '/mypage/address'} ? 'active'">
						   お届け先管理
						</a>
					</li>
					<li>
						<a th:href="@{/favorites/{userId}(userId=${#authentication.principal.id})}" 
						   th:classappend="${currentPath == '/mypage/wishlist'} ? 'active'"
						   sec:authorize="isAuthenticated()">
						   お気に入り
						</a>

					</li>
					<li>
						<a th:href="@{/mypage/delete}" 
						   th:classappend="${currentPath == '/mypage/delete'} ? 'active'">
						   退会手続き
						</a>
					</li>
				</ul>
			</aside>

    <section class="mypage-content">
      <h2>お届け先管理</h2>

      <div class="address-list">
        <h3>登録済み住所</h3>

        <ul>
          <li th:each="addr : ${addresses}">
            <div>
              <p th:text="${addr.recipientName}">氏名</p>
              <p th:text="'〒' + ${addr.postalCode}">郵便番号</p>
              <p th:text="${addr.address}">住所</p>
              <p th:text="${addr.phone}">電話番号</p>
            </div>

            <!-- 削除フォーム（見た目は同じ） -->
            <form th:action="@{/mypage/address/delete}" method="post" style="margin-top:10px;">
              <input type="hidden" name="id" th:value="${addr.id}">
              <button class="btn" type="submit">削除</button>
            </form>
          </li>
        </ul>

        <h3>新しいお届け先を追加</h3>

        <form class="member-form"
              th:action="@{/mypage/address/add}"
              method="post"
              th:object="${newAddress}">
          
          <div class="form-group">
            <label>氏名</label>
            <input type="text" th:field="*{recipientName}" placeholder="例：山田太郎">
          </div>

          <div class="form-group">
            <label>郵便番号</label>
            <input type="text" th:field="*{postalCode}" placeholder="例：160-0022">
          </div>

          <div class="form-group">
            <label>住所</label>
            <input type="text" th:field="*{address}" placeholder="例：東京都新宿区1-2-3">
          </div>

          <div class="form-group">
            <label>電話番号</label>
            <input type="text" th:field="*{phone}" placeholder="例：080-1234-5678">
          </div>

          <div class="form-actions">
            <button type="submit" class="btn">追加</button>
          </div>
        </form>

      </div>
    </section>
  </main>

  <footer class="main-footer">
    <p>&copy; 2025 VOIDR STORE. All rights reserved.</p>
  </footer>

</body>
</html>
