<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>退会確認 | VOIDR</title>
<link rel="stylesheet" th:href="@{/css/mypage/mypage.css}">
<link rel="stylesheet" th:href="@{/css/ec/header.css}">
<style>
  		/* マイページのCSSが上書きしたヘッダーの位置を戻す */
  		.fixed-header {
  			position: fixed;
  			top: 0;
  			left: 0;
  			width: 100%;
  			z-index: 9999;
  		}

  		/* カートアイコンのバッジが崩れないようにする */
  		.cart-icon-wrap {
  			position: relative !important;
  			display: inline-flex !important;
  			align-items: center !important;
  		}

  		.cart-count-badge {
  			position: absolute !important;
  			top: -5px !important;
  			right: -8px !important;
  		}

  		/* マイページでもカートバッジを完全な丸に固定 */
  		.cart-count-badge {
  		    position: absolute !important;
  		    top: -5px !important;
  		    right: -8px !important;

  		    background-color: red !important;
  		    color: white !important;
  		    font-size: 12px !important;
  		    font-weight: bold !important;

  		    height: 18px !important;          /* 高さ固定 */
  		    min-width: 18px !important;       /* 最小サイズは正円 */
  		    padding: 0 6px !important;        /* 2桁以上の時に横幅が広がる */

  		    border-radius: 50% !important;    /* 丸/楕円 */
  		    display: none;                     /* 初期は非表示 */
  		    text-align: center;
  		    line-height: 18px;                 /* 縦中央揃え */
  		    white-space: nowrap;               /* 折り返さない */
  		    box-sizing: border-box;            /* paddingを含めた幅調整 */
  		}
  	</style>
</head>
<body>

<div th:replace="fragments/header :: header"></div>

<main class="mypage-container">
  <aside class="mypage-sidebar">
    <h2>メニュー</h2>
    <ul>
      <li><a th:href="@{/mypage/orders}" th:classappend="${currentPath == '/mypage/orders'} ? 'active'">購入履歴</a></li>
      <li><a th:href="@{/mypage/edit}" th:classappend="${currentPath == '/mypage/edit'} ? 'active'">会員情報変更</a></li>
      <li><a th:href="@{/mypage/address}" th:classappend="${currentPath == '/mypage/address'} ? 'active'">お届け先管理</a></li>
      <li>
        <a th:href="@{/favorites/{userId}(userId=${#authentication.principal.id})}" 
           th:classappend="${currentPath == '/mypage/wishlist'} ? 'active'"
           sec:authorize="isAuthenticated()">お気に入り
        </a>
      </li>
      <li><a th:href="@{/mypage/delete}" th:classappend="${currentPath == '/mypage/delete'} ? 'active'">退会手続き</a></li>
    </ul>
  </aside>

  <section class="mypage-content">
    <h2>退会確認</h2>

    <p>以下の理由で退会されます：</p>

    <!-- ▼ 選択式の理由 -->
    <p th:text="${reason}" class="username"></p>

    <!-- ▼ ★ 自由入力の理由（空でなければ表示） -->
    <p th:if="${detailReason != null and detailReason != ''}">
      <strong>詳細理由：</strong><br>
      <span th:text="${detailReason}"></span>
    </p>

    <p>この操作は取り消せません。<br>アカウント情報・購入履歴など全て削除されます。</p>

    <form th:action="@{/mypage/delete/execute}" method="post">
      <!-- 隠し input で理由を送る -->
      <input type="hidden" name="reason" th:value="${reason}">
      
      <!-- ★ detailReason も渡す -->
      <input type="hidden" name="detailReason" th:value="${detailReason}">
      
      <div class="form-actions">
        <button type="submit" class="btn">退会を確定する</button>
        <a th:href="@{/mypage}" class="btn" style="background:#555;">キャンセル</a>
      </div>
    </form>
  </section>
</main>

<footer class="main-footer">
  <p>&copy; 2025 VOIDR STORE. All rights reserved.</p>
</footer>

</body>
</html>
