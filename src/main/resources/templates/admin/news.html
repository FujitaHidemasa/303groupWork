<!--/* ============================================================
  新着情報管理ページ（11/17 更新）

  【現在の実装状況】
  ・news テーブルと連携し、新着情報の一覧表示を実装済み
  ・新着情報の登録（追加）が可能
  ・新着情報の編集／削除も実装済み
  ・登録された新着情報はトップページに新しい順で表示される

  【未実装部分】
  ・特になし（今後、必要な場合に追記）

  【補足】
  ・Service / Mapper は NewsService / NewsMapper を利用
  ・/admin/** へのアクセス制限は後日 Spring Security で設定予定
=============================================================== */-->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ja"
	th:replace="layout/admin_base :: admin_base(~{::content}, '新着情報管理', ~{::assets})">

	<th:block th:fragment="assets">
		<link rel="stylesheet" th:href="@{/css/admin/news.css}">
	</th:block>
	
<th:block th:fragment="content">
	<div class="table-container">
		<section class="section">
			<h1>新着情報管理</h1>
			<p style="margin-bottom: 16px; color: #666;">
				最新3件のみがストアのトップページに表示されます。
			</p>

			<!-- フラッシュメッセージ -->
			<div th:if="${successMessage}"
				style="padding:8px; margin-bottom:12px; background:#e6ffed; border:1px solid #9ae6b4;">
				<span th:text="${successMessage}"></span>
			</div>
			<div th:if="${errorMessage}"
				style="padding:8px; margin-bottom:12px; background:#ffe6e6; border:1px solid #feb2b2;">
				<span th:text="${errorMessage}"></span>
			</div>
			
			<!-- 登録フォーム -->
			    <form th:action="@{/admin/news/create}" method="post" class="news-inline-form">
					<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

			      <!-- 日付 -->
			      <input type="date" id="newsDate" name="newsDate" class="date-input">

			      <!-- 内容 -->
			      <input type="text" name="content" placeholder="内容を入力（※日付が空欄の場合は自動的に今日の日付で登録）" required class="content-input">

			      <!-- ボタン -->
			      <button type="submit" class="btn-submit">＋ 登録</button>

			    </form>

			
			<!-- 一覧テーブル -->
			<table class="admin-table">
				<thead>
					<tr>
						<th style="width:5%;">ID</th>
						<th style="width:15%;">日付</th>
						<th>内容</th>
						<th style="width:15%;">操作</th>
					</tr>
				</thead>
				<tbody>
					<!-- データが1件以上ある場合 -->
					<tr th:each="n : ${newsList}">
						<td th:text="${n.id}">1</td>
						<td th:text="${#temporals.format(n.newsDate, 'yyyy/MM/dd')}">2025/11/20</td>
						<td th:text="${n.content}">ニュース内容</td>
						<td>
							<div style="display:flex; gap:8px;">
								<!-- 編集ボタン -->
								<a th:href="@{/admin/news/{id}/edit(id=${n.id})}" class="btn btn-edit">編集</a>

								<!-- 削除フォーム -->
								<form th:action="@{/admin/news/{id}/delete(id=${n.id})}" method="post"
									onsubmit="return confirm('この新着情報を削除してよろしいですか？');">
									<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
									<button type="submit" class="btn btn-delete">削除</button>
								</form>
							</div>
						</td>
					</tr>

					<!-- データが0件の場合 -->
					<tr th:if="${#lists.isEmpty(newsList)}">
						<td colspan="4" style="text-align:center; padding:12px; color:#888;">
							新着情報がまだ登録されていません。
						</td>
					</tr>
				</tbody>
			</table>
		</section>
	</div>
</th:block>

</html>