<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ja"
      th:replace="layout/admin_base :: admin_base(~{::content}, 'お問い合わせ詳細', ~{::assets})">

<!-- ページ本体 -->
<th:block th:fragment="content">
  <section class="section">
    <h1>お問い合わせ詳細</h1>

    <p>
      <a th:href="@{/admin/contacts}">← お問い合わせ一覧に戻る</a>
    </p>

    <!-- ユーザーから送られた内容だけ表示 -->
    <div class="detail-card">
      <dl>
        <dt>ID</dt>
        <dd th:text="${contact.id}">1</dd>

        <dt>受付日時</dt>
        <dd th:text="${#temporals.format(contact.createdAt, 'yyyy/MM/dd HH:mm')}">
          2025/11/01 12:00
        </dd>

        <dt>名前</dt>
        <dd th:text="${contact.name}">山田 太郎</dd>

        <dt>Email</dt>
        <dd th:text="${contact.email}">taro@example.com</dd>

        <dt>件名</dt>
        <dd th:text="${contact.subject}">商品について</dd>

        <dt>お問い合わせ内容</dt>
        <dd>
          <pre th:text="${contact.message}" class="message-block">
お問い合わせ内容がここに表示されます。
          </pre>
        </dd>

        <dt>ステータス</dt>
        <dd>
          <span th:switch="${contact.status}">
            <span th:case="'NEW'" style="color:red;">未対応</span>
            <span th:case="'IN_PROGRESS'" style="color:orange;">対応中</span>
            <span th:case="'RESOLVED'" style="color:green;">対応済</span>
            <span th:case="*"
                  th:text="${contact.status}">その他</span>
          </span>
        </dd>

        <dt>対応完了日時</dt>
        <dd th:text="${contact.repliedAt != null ?
                      #temporals.format(contact.repliedAt, 'yyyy/MM/dd HH:mm') :
                      '（未対応）'}">
          2025/11/02 09:00
        </dd>
      </dl>
    </div>

    <!-- ステータスだけ更新できるシンプルなフォーム -->
    <section class="section">
      <h2>ステータス更新</h2>
      <form th:action="@{/admin/contacts/updateStatus}" method="post" class="status-form">
        <input type="hidden" name="id" th:value="${contact.id}">

        <div class="form-row">
          <label>ステータス：</label>
          <select name="status">
            <option value="NEW" th:selected="${contact.status} == 'NEW'">未対応</option>
            <option value="IN_PROGRESS" th:selected="${contact.status} == 'IN_PROGRESS'">対応中</option>
            <option value="RESOLVED" th:selected="${contact.status} == 'RESOLVED'">対応済</option>
          </select>
        </div>

        <div class="form-row">
          <button type="submit">更新する</button>
        </div>
      </form>
    </section>
  </section>
</th:block>

<!-- ページ固有の CSS -->
<th:block th:fragment="assets">
  <style>
    .detail-card dl {
      display: grid;
      grid-template-columns: 150px 1fr;
      row-gap: 8px;
      column-gap: 16px;
      margin-bottom: 24px;
    }
    .detail-card dt {
      font-weight: bold;
      text-align: right;
    }
    .detail-card dd {
      margin: 0;
    }
	.detail-card .message-block {
	  white-space: pre-wrap;
	  background-color: #ffffff;
	  padding: 12px 16px;
	  border-radius: 4px;
	  border: 1px solid #cccccc;

	  color: #000000 !important;
	  font-size: 15px;
	  line-height: 1.7;
	  font-weight: 500;
	}

    .status-form {
      max-width: 400px;
    }
    .status-form .form-row {
      margin-bottom: 12px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
  </style>
</th:block>

</html>
